{% extends "admin_layout.html" %}

{% block content %}
<style>
    body {
        font-family: Arial, sans-serif;
    }

    .section-title {
        text-align: center;
        margin: 30px 0 20px;
    }

    .portfolio-form {
        width: 500px;
        margin: auto;
        padding: 25px;
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 6px;
    }

    .input-field,
    select,
    input[type="file"],
    textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        transition: 0.3s;
    }

    .input-field:focus,
    select:focus,
    input[type="file"]:focus,
    textarea:focus {
        border-color: black;
        outline: none;
    }

    .submit-btn {
        width: 100%;
        background: black;
        color: white;
        padding: 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: 0.3s;
    }

    .submit-btn:hover {
        background: #333;
    }

    .error {
        color: red;
        font-size: 13px;
        margin-top: 4px;
    }

    hr {
        margin: 50px 0;
    }

    /* Testimonial List Grid */
    .portfolio-list {
        width: 85%;
        margin: auto;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 25px;
    }

    .portfolio-item {
        background: white;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        text-align: center;
        transition: 0.3s;
    }

    .portfolio-item:hover {
        transform: translateY(-5px);
    }

    .portfolio-item img {
        width: 100%;
        height: 170px;
        object-fit: cover;
        border-radius: 10px;
        margin-bottom: 12px;
    }

    .portfolio-item h3 {
        margin: 10px 0 5px;
    }

    .portfolio-item p {
        color: #555;
        margin-bottom: 15px;
    }

    .portfolio-actions a {
        display: inline-block;
        margin: 5px;
        padding: 6px 12px;
        border-radius: 6px;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: 0.3s;
    }

    .edit-btn {
        background: #007bff;
        color: white;
    }

    .edit-btn:hover {
        background: #0056b3;
    }

    .delete-btn {
        background: #dc3545;
        color: white;
    }

    .delete-btn:hover {
        background: #a71d2a;
    }
</style>

<h2 class="section-title">
    {% if edit_mode %} Edit Testimonial {% else %} Add Testimonial {% endif %}
</h2>

<form method="POST" enctype="multipart/form-data" class="portfolio-form">
    {% csrf_token %}

    <div class="form-group">
        <label>Name</label>
        {{ form.name }}
        <div class="error">{{ form.name.errors }}</div>
    </div>

    <div class="form-group">
        <label>Role</label>
        {{ form.role }}
        <div class="error">{{ form.role.errors }}</div>
    </div>

    <div class="form-group">
        <label>Testimonial Text</label>
        {{ form.text }}
        <div class="error">{{ form.text.errors }}</div>
    </div>

    <div class="form-group">
        <label>Image</label>
        {{ form.image }}
        <div class="error">{{ form.image.errors }}</div>
    </div>

    <!-- <div class="form-group">
        <label>Stars (1-5)</label>
        {{ form.stars }}
        <div class="error">{{ form.stars.errors }}</div>
    </div> -->

    <button type="submit" class="submit-btn">
        {% if edit_mode %} Update Testimonial {% else %} Add Testimonial {% endif %}
    </button>
</form>

<hr>

<h2 class="section-title">Testimonial List</h2>

<div class="portfolio-list">
{% for t in testimonials %}
    <div class="portfolio-item">
        <img src="{{ t.image.url }}">
        <h3>{{ t.name }}</h3>
        <p>{{ t.role }}</p>
        <p>{{ t.text|truncatechars:100 }}</p>
        <p>Stars: {{ t.stars }}/5</p>

        <div class="portfolio-actions">
            <a href="{% url 'edit_testimonial' t.pk %}" class="edit-btn">Edit</a>
            <a href="{% url 'delete_testimonial' t.pk %}" 
               class="delete-btn"
               onclick="return confirm('Delete this testimonial?')">
               Delete
            </a>
        </div>
    </div>
{% endfor %}
</div>

{% endblock %}